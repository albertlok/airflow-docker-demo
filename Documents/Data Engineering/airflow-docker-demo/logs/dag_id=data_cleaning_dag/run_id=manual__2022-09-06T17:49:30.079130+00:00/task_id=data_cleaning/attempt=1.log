[2022-09-06 17:49:32,374] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: data_cleaning_dag.data_cleaning manual__2022-09-06T17:49:30.079130+00:00 [queued]>
[2022-09-06 17:49:32,393] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: data_cleaning_dag.data_cleaning manual__2022-09-06T17:49:30.079130+00:00 [queued]>
[2022-09-06 17:49:32,394] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2022-09-06 17:49:32,396] {taskinstance.py:1377} INFO - Starting attempt 1 of 1
[2022-09-06 17:49:32,397] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2022-09-06 17:49:32,425] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): data_cleaning> on 2022-09-06 17:49:30.079130+00:00
[2022-09-06 17:49:32,440] {standard_task_runner.py:52} INFO - Started process 148 to run task
[2022-09-06 17:49:32,449] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'data_cleaning_dag', 'data_cleaning', 'manual__2022-09-06T17:49:30.079130+00:00', '--job-id', '12', '--raw', '--subdir', 'DAGS_FOLDER/data_cleaning_dag/.ipynb_checkpoints/data_cleaning-checkpoint.py', '--cfg-path', '/tmp/tmp1lptvq_k', '--error-file', '/tmp/tmpflevfx9x']
[2022-09-06 17:49:32,456] {standard_task_runner.py:80} INFO - Job 12: Subtask data_cleaning
[2022-09-06 17:49:32,579] {task_command.py:371} INFO - Running <TaskInstance: data_cleaning_dag.data_cleaning manual__2022-09-06T17:49:30.079130+00:00 [running]> on host ffa74c704a13
[2022-09-06 17:49:32,706] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=data_cleaning_dag
AIRFLOW_CTX_TASK_ID=data_cleaning
AIRFLOW_CTX_EXECUTION_DATE=2022-09-06T17:49:30.079130+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2022-09-06T17:49:30.079130+00:00
[2022-09-06 17:49:33,272] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 79330 entries, 0 to 79329
Data columns (total 31 columns):
 #   Column                       Non-Null Count  Dtype  
---  ------                       --------------  -----  
 0   IsCanceled                   79330 non-null  int64  
 1   LeadTime                     79330 non-null  int64  
 2   ArrivalDateYear              79330 non-null  int64  
 3   ArrivalDateMonth             79330 non-null  object 
 4   ArrivalDateWeekNumber        79330 non-null  int64  
 5   ArrivalDateDayOfMonth        79330 non-null  int64  
 6   StaysInWeekendNights         79330 non-null  int64  
 7   StaysInWeekNights            79330 non-null  int64  
 8   Adults                       79330 non-null  int64  
 9   Children                     79326 non-null  float64
 10  Babies                       79330 non-null  int64  
 11  Meal                         79330 non-null  object 
 12  Country                      79306 non-null  object 
 13  MarketSegment                79330 non-null  object 
 14  DistributionChannel          79330 non-null  object 
 15  IsRepeatedGuest              79330 non-null  int64  
 16  PreviousCancellations        79330 non-null  int64  
 17  PreviousBookingsNotCanceled  79330 non-null  int64  
 18  ReservedRoomType             79330 non-null  object 
 19  AssignedRoomType             79330 non-null  object 
 20  BookingChanges               79330 non-null  int64  
 21  DepositType                  79330 non-null  object 
 22  Agent                        79330 non-null  object 
 23  Company                      79330 non-null  object 
 24  DaysInWaitingList            79330 non-null  int64  
 25  CustomerType                 79330 non-null  object 
 26  ADR                          79330 non-null  float64
 27  RequiredCarParkingSpaces     79330 non-null  int64  
 28  TotalOfSpecialRequests       79330 non-null  int64  
 29  ReservationStatus            79330 non-null  object 
 30  ReservationStatusDate        79330 non-null  object 
dtypes: float64(2), int64(16), object(13)
memory usage: 18.8+ MB
[2022-09-06 17:49:33,488] {logging_mixin.py:115} INFO - <class 'pandas.core.frame.DataFrame'>
RangeIndex: 79330 entries, 0 to 79329
Data columns (total 31 columns):
 #   Column                       Non-Null Count  Dtype  
---  ------                       --------------  -----  
 0   IsCanceled                   79330 non-null  int64  
 1   LeadTime                     79330 non-null  int64  
 2   ArrivalDateYear              79330 non-null  int64  
 3   ArrivalDateMonth             79330 non-null  object 
 4   ArrivalDateWeekNumber        79330 non-null  int64  
 5   ArrivalDateDayOfMonth        79330 non-null  int64  
 6   StaysInWeekendNights         79330 non-null  int64  
 7   StaysInWeekNights            79330 non-null  int64  
 8   Adults                       79330 non-null  int64  
 9   Children                     79326 non-null  float64
 10  Babies                       79330 non-null  int64  
 11  Meal                         79330 non-null  object 
 12  Country                      79306 non-null  object 
 13  MarketSegment                79330 non-null  object 
 14  DistributionChannel          79330 non-null  object 
 15  IsRepeatedGuest              79330 non-null  int64  
 16  PreviousCancellations        79330 non-null  int64  
 17  PreviousBookingsNotCanceled  79330 non-null  int64  
 18  ReservedRoomType             79330 non-null  object 
 19  AssignedRoomType             79330 non-null  object 
 20  BookingChanges               79330 non-null  int64  
 21  DepositType                  79330 non-null  object 
 22  Agent                        79330 non-null  object 
 23  Company                      79330 non-null  object 
 24  DaysInWaitingList            79330 non-null  int64  
 25  CustomerType                 79330 non-null  object 
 26  ADR                          79330 non-null  float64
 27  RequiredCarParkingSpaces     79330 non-null  int64  
 28  TotalOfSpecialRequests       79330 non-null  int64  
 29  ReservationStatus            79330 non-null  object 
 30  ReservationStatusDate        79330 non-null  object 
dtypes: float64(2), int64(16), object(13)
memory usage: 18.8+ MB
[2022-09-06 17:49:33,491] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/data_cleaning_dag/.ipynb_checkpoints/data_cleaning-checkpoint.py", line 28, in data_cleaning
    cleaned_data.tocsv('processed_data/processed_hotel_data.csv', index=False)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/generic.py", line 5487, in __getattr__
    return object.__getattribute__(self, name)
AttributeError: 'DataFrame' object has no attribute 'tocsv'
[2022-09-06 17:49:33,520] {taskinstance.py:1420} INFO - Marking task as FAILED. dag_id=data_cleaning_dag, task_id=data_cleaning, execution_date=20220906T174930, start_date=20220906T174932, end_date=20220906T174933
[2022-09-06 17:49:33,545] {standard_task_runner.py:97} ERROR - Failed to execute job 12 for task data_cleaning ('DataFrame' object has no attribute 'tocsv'; 148)
[2022-09-06 17:49:33,591] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-09-06 17:49:33,647] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
